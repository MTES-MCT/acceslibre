{% extends "editorial/base.html" %}
{% load humanize %}
{% load i18n %}
{% load l10n %}
{% load static %}
{% block page_title %}
    {% translate "Statistiques" %}
{% endblock page_title %}
{% block robots %}
    noindex, nofollow
{% endblock robots %}
{% block breadcrumb %}
    <div class="fr-container">
        <nav role="navigation"
             class="fr-breadcrumb fr-mt-3w fr-mt-md-2w"
             aria-label="{% translate "Vous êtes ici :" %}">
            <button class="fr-breadcrumb__button"
                    aria-expanded="false"
                    aria-controls="breadcrumb-navigation">{% translate "Voir le fil d'Ariane" %}</button>
            <div class="fr-collapse" id="breadcrumb-navigation">
                <ol class="fr-breadcrumb__list">
                    <li>
                        <a class="fr-breadcrumb__link" href="{% url 'home' %}">{% translate "Accueil" %}</a>
                    </li>
                    <li>
                        <a class="fr-breadcrumb__link" aria-current="page">{% translate "Statistiques" %}</a>
                    </li>
                </ol>
            </div>
        </nav>
    </div>
{% endblock breadcrumb %}
{% block editorial_content %}
    <h1>{% translate "Statistiques d'Acceslibre" %}</h1>
    <div class="sections-container">
        <h2 class="fr-h4 fr-mb-0">{% translate "Contributions" %}</h2>
        <section class="tiles-section">
            <div class="fr-tile fr-tile--horizontal">
                <div class="fr-tile__body">
                    <div class="fr-tile__content">
                        <p class="fr-tile__title fr-h1 fr-mb-0">{{ nb_published_erps|intcomma }}</p>
                        <p class="fr-tile__desc">{% translate "Lieux référencés" %}</p>
                    </div>
                </div>
                <div class="fr-tile__header">
                    <div class="fr-tile__pictogram">
                        <img src="{% static 'img/challenges/accessibility.svg' %}"
                             aria-hidden="true"
                             alt=""
                             width="64"
                             height="64" />
                    </div>
                </div>
            </div>
            <div class="fr-tile fr-tile--horizontal">
                <div class="fr-tile__body">
                    <div class="fr-tile__content">
                        <p class="fr-h1 fr-mb-0 fr-tile__title">{{ nb_contributors|intcomma }}</p>
                        <p class="fr-tile__desc">{% translate "Contributeurs" %}</p>
                    </div>
                </div>
                <div class="fr-tile__header">
                    <div class="fr-tile__pictogram">
                        <img src="{% static 'img/challenges/mental-disabilities.svg' %}"
                             aria-hidden="true"
                             alt=""
                             width="64"
                             height="64" />
                    </div>
                </div>
            </div>
        </section>
        <section>
            <h2 class="fr-h4">{% translate "Nombre d'établissements référencés" %}</h2>
            <div class="fr-table fr-mb-0">
                <div class="fr-table__wrapper">
                    <div class="fr-table__container">
                        <div class="fr-table__content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>{% translate "Date" %}</th>
                                        <th>{% translate "Nombre d'établissements référencés" %}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for erp in total_erps %}
                                        <tr>
                                            <td class="text--capitalize">{{ erp.0|date:"F Y" }}</td>
                                            <td>{{ erp.1|intcomma }}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section>
            <h2 class="fr-h4">{% translate "Consultation des données" %}</h2>
            <div class="tiles-section">
                <div class="fr-tile fr-tile--horizontal">
                    <div class="fr-tile__body">
                        <div class="fr-tile__content">
                            <p class="fr-h1 fr-mb-0 fr-tile__title">{{ nb_unique_visitors|intcomma }}</p>
                            <p class="fr-tile__desc">{% translate "Visiteurs uniques sur les 30 derniers jours" %}</p>
                        </div>
                    </div>
                </div>
                <div class="fr-tile fr-tile--horizontal">
                    <div class="fr-tile__body">
                        <div class="fr-tile__content">
                            <p class="fr-h1 fr-mb-0 fr-tile__title">{{ nb_widget_open|intcomma }}</p>
                            <p class="fr-tile__desc">{% translate "Consultation sur des sites partenaires" %}</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section>
            <h2 class="fr-h4">{% translate "Qualité des données" %}</h2>
            <div class="tiles-section">
                <div class="fr-tile fr-tile--horizontal">
                    <div class="fr-tile__body">
                        <div class="fr-tile__content">
                            <p class="fr-h1 fr-mb-0 fr-tile__title">{{ average_completion_rate }}</p>
                            <p class="fr-tile__desc">{% translate "Taux de remplissage moyen des fiches" %}</p>
                        </div>
                    </div>
                </div>
                <div class="fr-tile fr-tile--horizontal">
                    <div class="fr-tile__body">
                        <div class="fr-tile__content">
                            <p class="fr-h1 fr-mb-0 fr-tile__title">{{ last_12_months_created_or_updated_erps }}</p>
                            <p class="fr-tile__desc">{% translate "Taux de fiches créées ou modifiées durant les 12 derniers mois" %}</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section>
            <h2 class="fr-h4">{% translate "Remplissage des fiches" %}</h2>
            <div class="fr-table">
                <div class="fr-table__wrapper">
                    <div class="fr-table__container">
                        <div class="fr-table__content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>{% translate "Nombre d'informations remplies" %}</th>
                                        <th>{% translate "Nombre de fiches" %}</th>
                                        <th>{% translate "Part de fiches" %}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for erp_completion in erp_completion_totals %}
                                        <tr>
                                            <td class="text--capitalize">{{ erp_completion.0 }}</td>
                                            <td>{{ erp_completion.1|intcomma }}</td>
                                            <td>0%</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
{% endblock editorial_content %}
