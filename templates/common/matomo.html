<!-- Matomo -->
<script nonce="{{ request.csp_nonce }}">
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  _paq.push(['enableHeartBeatTimer']);
  (function () {
    var u = "//stats.beta.gouv.fr/";
    _paq.push(['setTrackerUrl', u + 'matomo.php']);
    _paq.push(['setSiteId', '3']);

    var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
    g.async = true; g.src = u + 'matomo.js'; s.parentNode.insertBefore(g, s);
  })();

  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll('[data-track-event]').forEach(function(elt){
      elt.addEventListener('click', function(){
        try {
          const rawData = elt.getAttribute("data-track-event") || "";
          if (rawData.length > 0) {
            _paq.push(["trackEvent"].concat(rawData.split(",")));
          }
        } catch (e) {
          console.error("Error while tracking event: ", e);
        }
      })
    })
  })
</script>
<noscript>
    <img src="//stats.beta.gouv.fr/matomo.php?idsite=3&amp;rec=1" alt="">
</noscript>
<!-- End Matomo Code -->
