<script id="around-data" type="application/json">
  {{ around | default_if_none:"null" }}
</script>
<script id="commune-data" type="application/json">
  {% if commune_json %}{{ commune_json | safe }}{% else %}null{% endif %}
</script>
<script id="erp-pk-data" type="application/json">
  {% if erp %}{{ erp.pk }}{% else %}null{% endif %}
</script>
<script id="erps-data" type="application/json">
  {{ geojson_list | safe }}
</script>

<div id="app-map" class="{% if map_classes %}{{ map_classes }}{% else %}a4a-app-map{% endif %}">
  <noscript>
    <div class="p-3">
      <div class="alert alert-warning">
        <i aria-hidden="true" class="icon icon-exclamation-circle"></i>
        JavaScript doit être activé pour utiliser la cartographie interactive.
      </div>
    </div>
  </noscript>
</div>
<script>
  a4a.dom.ready(function() {
    const around_data = JSON.parse(document.getElementById("around-data").textContent);
    const commune_data = JSON.parse(document.getElementById("commune-data").textContent);
    const erps_data = JSON.parse(document.getElementById("erps-data").textContent);
    const erp_id = JSON.parse(document.getElementById("erp-pk-data").textContent);
    a4a.geo.initAppMap(commune_data, erp_id, around_data, erps_data);
  });
</script>
